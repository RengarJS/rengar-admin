import{h as x}from"./menu-xnSkBs1f.js";import{r as B,a as R}from"./role-DFEt8TaD.js";import{t as f}from"./index-B7XrkSjs.js";import{k as T,a7 as b,r as o,a5 as A,U as D,Z as s,$ as u,M as t,Y as K,a6 as k,j as U,X as V}from"./vue-DI2LXsg1.js";import{P as E,K as I,o as L,Q as M,G as S}from"./naive-ui-C1U0z9Qv.js";const $={class:"max-w-[600px]"},j={class:"my-4"},Z=T({name:"setting-role-config",__name:"[id]",setup(z){const g=b(),_=Number(g.params.id),l=o([]),v=o([]),i=o(!1);async function h(){i.value=!0;const[c,e]=await f(x()),[a,n]=await f(B(_));i.value=!1,!(c||a)&&(v.value=e,l.value=n.codes)}h();const r=o(""),d=o(!1),p=A("treeRef");async function y(){d.value=!0;const{keys:c}=p.value.getCheckedData(),{keys:e}=p.value.getIndeterminateData(),[a]=await f(R({id:_,codes:c.filter(n=>!e.includes(n)),halfCodes:e}));d.value=!1,!a&&window.$message.success("保存成功")}return(c,e)=>{const a=S,n=L,w=M,C=I,N=E;return V(),D("div",$,[s(N,{show:t(i)},{default:u(()=>[s(C,{title:"菜单管理",size:"small"},{"header-extra":u(()=>[s(a,{type:"primary",loading:t(d),onClick:y},{default:u(()=>e[2]||(e[2]=[U("保存")])),_:1},8,["loading"])]),default:u(()=>[K("div",j,[s(n,{value:t(r),"onUpdate:value":e[0]||(e[0]=m=>k(r)?r.value=m:null),placeholder:"搜索菜单"},null,8,["value"])]),s(w,{"checked-keys":t(l),"onUpdate:checkedKeys":e[1]||(e[1]=m=>k(l)?l.value=m:null),data:t(v),ref_key:"treeRef",ref:p,pattern:t(r),"label-field":"name","key-field":"code",checkable:"",cascade:"","block-line":"","show-irrelevant-nodes":!0},null,8,["checked-keys","data","pattern"])]),_:1})]),_:1},8,["show"])])}}});export{Z as default};
