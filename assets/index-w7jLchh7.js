import{t as _,d as ke,c as Ne,e as xe}from"./main-BnTznlxz.js";import{k as J,ad as F,a5 as oe,r as i,a6 as O,W as M,a1 as a,N as n,_ as e,X as S,j as p,Y as C,w as $e,V as Ce,I as E,Z as j,ae,a3 as le}from"./vue-wKwVChXD.js";import{m as Re,b as Me,a as Ie,c as Te,d as Ue,e as Ae,f as Be,g as ze}from"./menu-gyaCMFmW.js";import{b as ue,d as Q,e as W,s as X,L as Y,M as Z,c as H,o as he,p as qe,O as Se,J as De,P as Ee,B as R,r as q,Q as Fe,R as Le,T as Pe,K as se}from"./naive-ui-Ds0VUWV_.js";const Ge=J({__name:"MenuAddModal",props:F({type:{},parent:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:F(["success"],["update:show"]),setup(g,{emit:I}){const y=oe(g,"show"),k=I,o=i({}),r=O("formRef"),N={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},w=i(!1);async function A(){var m;const[d]=await _(r.value.validate());if(d)return!1;w.value=!0;const[s]=await _(Re({...n(o),parentId:g.type===1?0:g.parent.id}));if(w.value=!1,!s)return(m=window.$message)==null||m.success("新增成功"),k("success"),!0}return(d,s)=>{const m=W,c=Q,x=X,$=Z,T=Y,U=H,B=ue;return C(),M(B,{show:y.value,"onUpdate:show":s[3]||(s[3]=u=>y.value=u),preset:"dialog",title:d.type===1?"添加顶级菜单":"添加子菜单","positive-text":"确定","negative-text":"取消",loading:n(w),onPositiveClick:A},{default:a(()=>[e(U,{ref_key:"formRef",ref:r,model:n(o),rules:N,class:"my-8",size:"small","label-placement":"left","label-width":"auto"},{default:a(()=>[d.type===2?(C(),M(c,{key:0,label:"上级菜单"},{default:a(()=>{var u;return[e(m,{value:(u=d.parent)==null?void 0:u.name,disabled:""},null,8,["value"])]}),_:1})):S("",!0),e(c,{label:"菜单名称",path:"name"},{default:a(()=>[e(m,{value:n(o).name,"onUpdate:value":s[0]||(s[0]=u=>n(o).name=u),placeholder:"菜单名称"},null,8,["value"])]),_:1}),e(c,{label:"排序",path:"sort"},{default:a(()=>[e(x,{value:n(o).sort,"onUpdate:value":s[1]||(s[1]=u=>n(o).sort=u),min:1,precision:0,placeholder:"序号"},null,8,["value"])]),_:1}),e(c,{label:"状态",path:"status"},{default:a(()=>[e(T,{value:n(o).status,"onUpdate:value":s[2]||(s[2]=u=>n(o).status=u)},{default:a(()=>[e($,{value:1},{default:a(()=>s[4]||(s[4]=[p("启用")])),_:1}),e($,{value:0},{default:a(()=>s[5]||(s[5]=[p("禁用")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","loading"])}}}),Ve=J({__name:"ButtonAddModal",props:F({parent:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:F(["success"],["update:show"]),setup(g,{emit:I}){const y=oe(g,"show"),k=I,o=i({}),r=O("formRef"),N={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},w=i(!1);async function A(){var m;const[d]=await _(r.value.validate());if(d)return!1;w.value=!0;const[s]=await _(g.parent?Me({...n(o),parentId:g.parent.id}):Ie(o.value));if(w.value=!1,!s)return(m=window.$message)==null||m.success(`${g.parent?"新增":"编辑"}成功`),k("success"),!0}return(d,s)=>{const m=W,c=Q,x=X,$=Z,T=Y,U=H,B=ue;return C(),M(B,{show:y.value,"onUpdate:show":s[3]||(s[3]=u=>y.value=u),preset:"dialog",title:d.parent?"添加按钮":"编辑按钮","positive-text":"确定","negative-text":"取消",loading:n(w),onPositiveClick:A},{default:a(()=>[e(U,{ref_key:"formRef",ref:r,model:n(o),rules:N,class:"my-8",size:"small","label-placement":"left","label-width":"auto"},{default:a(()=>[d.parent?(C(),M(c,{key:0,label:"上级菜单"},{default:a(()=>{var u;return[e(m,{value:(u=d.parent)==null?void 0:u.name,disabled:""},null,8,["value"])]}),_:1})):S("",!0),e(c,{label:"按钮名称",path:"name"},{default:a(()=>[e(m,{value:n(o).name,"onUpdate:value":s[0]||(s[0]=u=>n(o).name=u),placeholder:"按钮名称"},null,8,["value"])]),_:1}),e(c,{label:"排序",path:"sort"},{default:a(()=>[e(x,{value:n(o).sort,"onUpdate:value":s[1]||(s[1]=u=>n(o).sort=u),min:1,precision:0,placeholder:"排序"},null,8,["value"])]),_:1}),e(c,{label:"状态",path:"status"},{default:a(()=>[e(T,{value:n(o).status,"onUpdate:value":s[2]||(s[2]=u=>n(o).status=u)},{default:a(()=>[e($,{value:1},{default:a(()=>s[4]||(s[4]=[p("启用")])),_:1}),e($,{value:0},{default:a(()=>s[5]||(s[5]=[p("禁用")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","loading"])}}}),Ke={class:"my-4"},je={class:"w-full flex items-center gap-4"},Je={class:"w-full flex-center"},Ye=J({name:"setting-menu",__name:"index",setup(g){const I=i([]),y=i(!1),k=i([]),o=i({}),r=i();async function N(){y.value=!0;const[l,t]=await _(Te());y.value=!1,!l&&(I.value=t)}N();function w(l){return e(q,{align:"center"},{default:()=>[e(se,{class:"text-sm",type:"primary"},{default:()=>[l.option.code]}),e("div",{class:"i-tabler:copy text-base text-primary",onClick:le(()=>{d(l.option.code)},["stop"])},null)]})}const{copy:A}=ke();async function d(l){var f,D;const[t]=await _(A(l));t?(f=window.$message)==null||f.error("复制失败"):(D=window.$message)==null||D.success("复制成功")}const s=i("");function m({option:l}){return{onClick(){var t;if(l.id===((t=r.value)==null?void 0:t.id)){r.value=void 0;return}r.value=l,o.value=xe(l)}}}function c(){r.value=void 0,k.value=[]}const x=i(!1),$=i(1);function T(l){$.value=l,x.value=!0}const U=O("formRef"),B={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},u=i(!1);async function re(){var f;const[l]=await _(U.value.validate());if(l)return;u.value=!0;const[t]=await _(Ue(o.value));u.value=!1,!t&&((f=window.$message)==null||f.success("保存成功"),N())}function ie(){var t;const l=window.$dialog.warning({title:"温馨提示",content:`确定要删除“${(t=r.value)==null?void 0:t.name}”吗？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{l.loading=!0;const[f]=await _(Ae(r.value.id));return l.loading=!1,f?!1:(window.$message.success("删除成功"),N(),c(),!0)}})}const z=i(!1),ee=i(),L=i([]),de=[{title:"按钮名称",key:"name"},{title:"按钮code",key:"code",render(l){return e(q,{align:"center"},{default:()=>[e(se,{class:"text-sm",type:"info"},{default:()=>[l.code]}),e("div",{class:"i-tabler:copy cursor-pointer text-base text-primary",onClick:le(()=>{d(l.code)},["stop"])},null)]})}},{title:"排序",key:"sort"},{title:"状态",key:"status",render(l){return e(Pe,{type:l.status===1?"success":"error"},{default:()=>[l.status===1?"启用":"禁用"]})}},{title:"操作",key:"action",width:120,render(l){return e(q,null,{default:()=>[e(R,{type:"info",size:"small",text:!0,onClick:()=>me(l)},{default:()=>[p("编辑")]}),e(R,{type:"error",size:"small",text:!0,onClick:()=>fe(l)},{default:()=>[p("删除")]})]})}}],P=i(!1);async function G(){P.value=!0;const[l,t]=await _(ze(r.value.id));if(P.value=!1,l){L.value=[];return}L.value=t}function pe(){ee.value=void 0,z.value=!0}$e(r,l=>{l&&G()});function me(l){ee.value=l,z.value=!0}function fe(l){const t=window.$dialog.warning({title:"温馨提示",content:`确定要删除“${l.name}”吗？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{t.loading=!0;const[f]=await _(Be(l.id));return t.loading=!1,f?!1:(window.$message.success("删除成功"),G(),!0)}})}return(l,t)=>{const f=W,D=Ee,V=De,ce=Se,K=qe,te=Fe,h=Q,ve=Ne,_e=X,ne=Z,ge=Y,ye=H,we=Le,be=he;return C(),Ce("div",null,[e(be,{cols:"1 800:2 1200:3","x-gap":16,"y-gap":16},{default:a(()=>[e(K,null,{default:a(()=>[e(ce,{show:n(y)},{default:a(()=>[e(V,{title:"菜单管理",size:"small"},{"header-extra":a(()=>[e(n(R),{type:"primary",size:"small",onClick:t[0]||(t[0]=v=>T(1))},{default:a(()=>t[11]||(t[11]=[p("添加顶级菜单")])),_:1})]),default:a(()=>[j("div",Ke,[e(f,{value:n(s),"onUpdate:value":t[1]||(t[1]=v=>E(s)?s.value=v:null),placeholder:"搜索菜单"},null,8,["value"])]),e(D,{"selected-keys":n(k),"onUpdate:selectedKeys":t[2]||(t[2]=v=>E(k)?k.value=v:null),data:n(I),pattern:n(s),"block-line":"","label-field":"name","key-field":"id","render-suffix":w,"show-irrelevant-nodes":!0,"node-props":m},null,8,["selected-keys","data","pattern"])]),_:1})]),_:1},8,["show"])]),_:1}),e(K,null,{default:a(()=>{var v;return[e(V,{size:"small",title:(v=n(r))==null?void 0:v.name},ae({default:a(()=>[e(te,{title:"温馨提示",type:"info"},{default:a(()=>t[12]||(t[12]=[p("点击菜单开始")])),_:1}),n(r)?(C(),M(ye,{key:0,ref_key:"formRef",ref:U,model:n(o),rules:B,class:"my-4",size:"small","label-placement":"left","label-width":"auto"},{default:a(()=>[e(h,{label:"菜单名称",path:"name"},{default:a(()=>[e(f,{value:n(o).name,"onUpdate:value":t[4]||(t[4]=b=>n(o).name=b),placeholder:"菜单名称"},null,8,["value"])]),_:1}),e(h,{label:"菜单code",path:"code"},{default:a(()=>[j("div",je,[e(f,{value:n(o).code,"onUpdate:value":t[5]||(t[5]=b=>n(o).code=b),disabled:"",placeholder:"菜单code",class:"flex-1"},null,8,["value"]),e(ve,{icon:"i-tabler:copy",class:"cursor-pointer text-base text-primary",onClick:t[6]||(t[6]=b=>d(n(o).code))})])]),_:1}),e(h,{label:"排序",path:"sort"},{default:a(()=>[e(_e,{value:n(o).sort,"onUpdate:value":t[7]||(t[7]=b=>n(o).sort=b),min:1,precision:0,placeholder:"序号"},null,8,["value"])]),_:1}),e(h,{label:"状态",path:"status"},{default:a(()=>[e(ge,{value:n(o).status,"onUpdate:value":t[8]||(t[8]=b=>n(o).status=b)},{default:a(()=>[e(ne,{value:1},{default:a(()=>t[15]||(t[15]=[p("启用")])),_:1}),e(ne,{value:0},{default:a(()=>t[16]||(t[16]=[p("禁用")])),_:1})]),_:1},8,["value"])]),_:1}),e(h,null,{default:a(()=>[j("div",Je,[e(n(R),{loading:n(u),type:"primary","attr-type":"submit",size:"small",onClick:re},{default:a(()=>t[17]||(t[17]=[p("保存")])),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])):S("",!0)]),_:2},[n(r)?{name:"header-extra",fn:a(()=>[e(n(q),null,{default:a(()=>[e(n(R),{type:"primary",ghost:"",size:"small",onClick:t[3]||(t[3]=b=>T(2))},{default:a(()=>t[13]||(t[13]=[p("添加子菜单")])),_:1}),e(n(R),{type:"error",ghost:"",size:"small",onClick:ie},{default:a(()=>t[14]||(t[14]=[p("删除")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["title"])]}),_:1}),e(K,null,{default:a(()=>[e(V,{size:"small",title:"按钮管理"},ae({default:a(()=>[n(r)?S("",!0):(C(),M(te,{key:0,title:"温馨提示",type:"info"},{default:a(()=>t[18]||(t[18]=[p("点击菜单开始")])),_:1})),n(r)?(C(),M(we,{key:1,size:"small",class:"mt-4",columns:de,data:n(L),loading:n(P)},null,8,["data","loading"])):S("",!0)]),_:2},[n(r)?{name:"header-extra",fn:a(()=>[e(n(q),null,{default:a(()=>[e(n(R),{type:"primary",ghost:"",size:"small",onClick:pe},{default:a(()=>t[19]||(t[19]=[p("添加按钮")])),_:1})]),_:1})]),key:"0"}:void 0]),1024)]),_:1})]),_:1}),e(Ge,{show:n(x),"onUpdate:show":t[9]||(t[9]=v=>E(x)?x.value=v:null),type:n($),parent:n(r),onSuccess:N},null,8,["show","type","parent"]),e(Ve,{show:n(z),"onUpdate:show":t[10]||(t[10]=v=>E(z)?z.value=v:null),parent:n(r),onSuccess:G},null,8,["show","parent"])])}}});export{Ye as default};
