import{t as _,d as ke,_ as Ne,e as xe}from"./index-B7XrkSjs.js";import{k as O,ad as F,a4 as oe,r as i,a5 as Q,V as R,$ as a,M as n,Z as e,W as S,j as p,X as C,w as $e,U as Ce,a6 as E,Y as j,ae,a2 as le}from"./vue-DI2LXsg1.js";import{m as Me,b as Re,a as Ue,c as Ae,d as Te,e as Be,f as Ie,g as ze}from"./menu-xnSkBs1f.js";import{k as ue,n as W,o as X,E as Y,M as Z,O as H,m as J,A as he,B as qe,P as Se,K as De,Q as Ee,G as M,D as q,R as Fe,T as Le,U as Ge,L as se}from"./naive-ui-C1U0z9Qv.js";const Pe=O({__name:"MenuAddModal",props:F({type:{},parent:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:F(["success"],["update:show"]),setup(g,{emit:U}){const y=oe(g,"show"),k=U,o=i({}),r=Q("formRef"),N={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},w=i(!1);async function B(){var m;const[d]=await _(r.value.validate());if(d)return!1;w.value=!0;const[s]=await _(Me({...n(o),parentId:g.type===1?0:g.parent.id}));if(w.value=!1,!s)return(m=window.$message)==null||m.success("新增成功"),k("success"),!0}return(d,s)=>{const m=X,c=W,x=Y,$=H,A=Z,T=J,I=ue;return C(),R(I,{show:y.value,"onUpdate:show":s[3]||(s[3]=u=>y.value=u),preset:"dialog",title:d.type===1?"添加顶级菜单":"添加子菜单","positive-text":"确定","negative-text":"取消",loading:n(w),onPositiveClick:B},{default:a(()=>[e(T,{ref_key:"formRef",ref:r,model:n(o),rules:N,class:"my-8",size:"small","label-placement":"left","label-width":"auto"},{default:a(()=>[d.type===2?(C(),R(c,{key:0,label:"上级菜单"},{default:a(()=>{var u;return[e(m,{value:(u=d.parent)==null?void 0:u.name,disabled:""},null,8,["value"])]}),_:1})):S("",!0),e(c,{label:"菜单名称",path:"name"},{default:a(()=>[e(m,{value:n(o).name,"onUpdate:value":s[0]||(s[0]=u=>n(o).name=u),placeholder:"菜单名称"},null,8,["value"])]),_:1}),e(c,{label:"排序",path:"sort"},{default:a(()=>[e(x,{value:n(o).sort,"onUpdate:value":s[1]||(s[1]=u=>n(o).sort=u),min:1,precision:0,placeholder:"序号"},null,8,["value"])]),_:1}),e(c,{label:"状态",path:"status"},{default:a(()=>[e(A,{value:n(o).status,"onUpdate:value":s[2]||(s[2]=u=>n(o).status=u)},{default:a(()=>[e($,{value:1},{default:a(()=>s[4]||(s[4]=[p("启用")])),_:1}),e($,{value:0},{default:a(()=>s[5]||(s[5]=[p("禁用")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","loading"])}}}),Ve=O({__name:"ButtonAddModal",props:F({parent:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:F(["success"],["update:show"]),setup(g,{emit:U}){const y=oe(g,"show"),k=U,o=i({}),r=Q("formRef"),N={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},w=i(!1);async function B(){var m;const[d]=await _(r.value.validate());if(d)return!1;w.value=!0;const[s]=await _(g.parent?Re({...n(o),parentId:g.parent.id}):Ue(o.value));if(w.value=!1,!s)return(m=window.$message)==null||m.success(`${g.parent?"新增":"编辑"}成功`),k("success"),!0}return(d,s)=>{const m=X,c=W,x=Y,$=H,A=Z,T=J,I=ue;return C(),R(I,{show:y.value,"onUpdate:show":s[3]||(s[3]=u=>y.value=u),preset:"dialog",title:d.parent?"添加按钮":"编辑按钮","positive-text":"确定","negative-text":"取消",loading:n(w),onPositiveClick:B},{default:a(()=>[e(T,{ref_key:"formRef",ref:r,model:n(o),rules:N,class:"my-8",size:"small","label-placement":"left","label-width":"auto"},{default:a(()=>[d.parent?(C(),R(c,{key:0,label:"上级菜单"},{default:a(()=>{var u;return[e(m,{value:(u=d.parent)==null?void 0:u.name,disabled:""},null,8,["value"])]}),_:1})):S("",!0),e(c,{label:"按钮名称",path:"name"},{default:a(()=>[e(m,{value:n(o).name,"onUpdate:value":s[0]||(s[0]=u=>n(o).name=u),placeholder:"按钮名称"},null,8,["value"])]),_:1}),e(c,{label:"排序",path:"sort"},{default:a(()=>[e(x,{value:n(o).sort,"onUpdate:value":s[1]||(s[1]=u=>n(o).sort=u),min:1,precision:0,placeholder:"排序"},null,8,["value"])]),_:1}),e(c,{label:"状态",path:"status"},{default:a(()=>[e(A,{value:n(o).status,"onUpdate:value":s[2]||(s[2]=u=>n(o).status=u)},{default:a(()=>[e($,{value:1},{default:a(()=>s[4]||(s[4]=[p("启用")])),_:1}),e($,{value:0},{default:a(()=>s[5]||(s[5]=[p("禁用")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","loading"])}}}),Ke={class:"my-4"},je={class:"w-full flex items-center gap-4"},Oe={class:"w-full flex-center"},Ze=O({name:"setting-menu",__name:"index",setup(g){const U=i([]),y=i(!1),k=i([]),o=i({}),r=i();async function N(){y.value=!0;const[l,t]=await _(Ae());y.value=!1,!l&&(U.value=t)}N();function w(l){return e(q,{align:"center"},{default:()=>[e(se,{class:"text-sm",type:"primary"},{default:()=>[l.option.code]}),e("div",{class:"i-tabler:copy text-base text-primary",onClick:le(()=>{d(l.option.code)},["stop"])},null)]})}const{copy:B}=ke();async function d(l){var f,D;const[t]=await _(B(l));t?(f=window.$message)==null||f.error("复制失败"):(D=window.$message)==null||D.success("复制成功")}const s=i("");function m({option:l}){return{onClick(){var t;if(l.id===((t=r.value)==null?void 0:t.id)){r.value=void 0;return}r.value=l,o.value=xe(l)}}}function c(){r.value=void 0,k.value=[]}const x=i(!1),$=i(1);function A(l){$.value=l,x.value=!0}const T=Q("formRef"),I={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},u=i(!1);async function re(){var f;const[l]=await _(T.value.validate());if(l)return;u.value=!0;const[t]=await _(Te(o.value));u.value=!1,!t&&((f=window.$message)==null||f.success("保存成功"),N())}function ie(){var t;const l=window.$dialog.warning({title:"温馨提示",content:`确定要删除“${(t=r.value)==null?void 0:t.name}”吗？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{l.loading=!0;const[f]=await _(Be(r.value.id));return l.loading=!1,f?!1:(window.$message.success("删除成功"),N(),c(),!0)}})}const z=i(!1),ee=i(),L=i([]),de=[{title:"按钮名称",key:"name"},{title:"按钮code",key:"code",render(l){return e(q,{align:"center"},{default:()=>[e(se,{class:"text-sm",type:"info"},{default:()=>[l.code]}),e("div",{class:"i-tabler:copy cursor-pointer text-base text-primary",onClick:le(()=>{d(l.code)},["stop"])},null)]})}},{title:"排序",key:"sort"},{title:"状态",key:"status",render(l){return e(Ge,{type:l.status===1?"success":"error"},{default:()=>[l.status===1?"启用":"禁用"]})}},{title:"操作",key:"action",width:120,render(l){return e(q,null,{default:()=>[e(M,{type:"info",size:"small",text:!0,onClick:()=>me(l)},{default:()=>[p("编辑")]}),e(M,{type:"error",size:"small",text:!0,onClick:()=>fe(l)},{default:()=>[p("删除")]})]})}}],G=i(!1);async function P(){G.value=!0;const[l,t]=await _(ze(r.value.id));if(G.value=!1,l){L.value=[];return}L.value=t}function pe(){ee.value=void 0,z.value=!0}$e(r,l=>{l&&P()});function me(l){ee.value=l,z.value=!0}function fe(l){const t=window.$dialog.warning({title:"温馨提示",content:`确定要删除“${l.name}”吗？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{t.loading=!0;const[f]=await _(Ie(l.id));return t.loading=!1,f?!1:(window.$message.success("删除成功"),P(),!0)}})}return(l,t)=>{const f=X,D=Ee,V=De,ce=Se,K=qe,te=Fe,h=W,ve=Ne,_e=Y,ne=H,ge=Z,ye=J,we=Le,be=he;return C(),Ce("div",null,[e(be,{cols:"1 800:2 1200:3","x-gap":16,"y-gap":16},{default:a(()=>[e(K,null,{default:a(()=>[e(ce,{show:n(y)},{default:a(()=>[e(V,{title:"菜单管理",size:"small"},{"header-extra":a(()=>[e(n(M),{type:"primary",size:"small",onClick:t[0]||(t[0]=v=>A(1))},{default:a(()=>t[11]||(t[11]=[p("添加顶级菜单")])),_:1})]),default:a(()=>[j("div",Ke,[e(f,{value:n(s),"onUpdate:value":t[1]||(t[1]=v=>E(s)?s.value=v:null),placeholder:"搜索菜单"},null,8,["value"])]),e(D,{"selected-keys":n(k),"onUpdate:selectedKeys":t[2]||(t[2]=v=>E(k)?k.value=v:null),data:n(U),pattern:n(s),"block-line":"","label-field":"name","key-field":"id","render-suffix":w,"show-irrelevant-nodes":!0,"node-props":m},null,8,["selected-keys","data","pattern"])]),_:1})]),_:1},8,["show"])]),_:1}),e(K,null,{default:a(()=>{var v;return[e(V,{size:"small",title:(v=n(r))==null?void 0:v.name},ae({default:a(()=>[e(te,{title:"温馨提示",type:"info"},{default:a(()=>t[12]||(t[12]=[p("点击菜单开始")])),_:1}),n(r)?(C(),R(ye,{key:0,ref_key:"formRef",ref:T,model:n(o),rules:I,class:"my-4",size:"small","label-placement":"left","label-width":"auto"},{default:a(()=>[e(h,{label:"菜单名称",path:"name"},{default:a(()=>[e(f,{value:n(o).name,"onUpdate:value":t[4]||(t[4]=b=>n(o).name=b),placeholder:"菜单名称"},null,8,["value"])]),_:1}),e(h,{label:"菜单code",path:"code"},{default:a(()=>[j("div",je,[e(f,{value:n(o).code,"onUpdate:value":t[5]||(t[5]=b=>n(o).code=b),disabled:"",placeholder:"菜单code",class:"flex-1"},null,8,["value"]),e(ve,{icon:"i-tabler:copy",class:"cursor-pointer text-base text-primary",onClick:t[6]||(t[6]=b=>d(n(o).code))})])]),_:1}),e(h,{label:"排序",path:"sort"},{default:a(()=>[e(_e,{value:n(o).sort,"onUpdate:value":t[7]||(t[7]=b=>n(o).sort=b),min:1,precision:0,placeholder:"序号"},null,8,["value"])]),_:1}),e(h,{label:"状态",path:"status"},{default:a(()=>[e(ge,{value:n(o).status,"onUpdate:value":t[8]||(t[8]=b=>n(o).status=b)},{default:a(()=>[e(ne,{value:1},{default:a(()=>t[15]||(t[15]=[p("启用")])),_:1}),e(ne,{value:0},{default:a(()=>t[16]||(t[16]=[p("禁用")])),_:1})]),_:1},8,["value"])]),_:1}),e(h,null,{default:a(()=>[j("div",Oe,[e(n(M),{loading:n(u),type:"primary","attr-type":"submit",size:"small",onClick:re},{default:a(()=>t[17]||(t[17]=[p("保存")])),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])):S("",!0)]),_:2},[n(r)?{name:"header-extra",fn:a(()=>[e(n(q),null,{default:a(()=>[e(n(M),{type:"primary",ghost:"",size:"small",onClick:t[3]||(t[3]=b=>A(2))},{default:a(()=>t[13]||(t[13]=[p("添加子菜单")])),_:1}),e(n(M),{type:"error",ghost:"",size:"small",onClick:ie},{default:a(()=>t[14]||(t[14]=[p("删除")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["title"])]}),_:1}),e(K,null,{default:a(()=>[e(V,{size:"small",title:"按钮管理"},ae({default:a(()=>[n(r)?S("",!0):(C(),R(te,{key:0,title:"温馨提示",type:"info"},{default:a(()=>t[18]||(t[18]=[p("点击菜单开始")])),_:1})),n(r)?(C(),R(we,{key:1,size:"small",class:"mt-4",columns:de,data:n(L),loading:n(G)},null,8,["data","loading"])):S("",!0)]),_:2},[n(r)?{name:"header-extra",fn:a(()=>[e(n(q),null,{default:a(()=>[e(n(M),{type:"primary",ghost:"",size:"small",onClick:pe},{default:a(()=>t[19]||(t[19]=[p("添加按钮")])),_:1})]),_:1})]),key:"0"}:void 0]),1024)]),_:1})]),_:1}),e(Pe,{show:n(x),"onUpdate:show":t[9]||(t[9]=v=>E(x)?x.value=v:null),type:n($),parent:n(r),onSuccess:N},null,8,["show","type","parent"]),e(Ve,{show:n(z),"onUpdate:show":t[10]||(t[10]=v=>E(z)?z.value=v:null),parent:n(r),onSuccess:P},null,8,["show","parent"])])}}});export{Ze as default};
